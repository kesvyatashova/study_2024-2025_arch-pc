---
## Front matter
title: "Лабораторная работа №8"
subtitle: "дисциплина: Архитектура компьютера"
author: "Савенкова Алиса Евгеньевна"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true # Table of contents
toc-depth: 2
lof: true # List of figures
lot: true # List of tables
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
	- spelling=modern
	- babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: IBM Plex Serif
romanfont: IBM Plex Serif
sansfont: IBM Plex Sans
monofont: IBM Plex Mono
mathfont: STIX Two Math
mainfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
romanfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
sansfontoptions: Ligatures=Common,Ligatures=TeX,Scale=MatchLowercase,Scale=0.94
monofontoptions: Scale=MatchLowercase,Scale=0.94,FakeStretch=0.9
mathfontoptions:
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float} # keep figures where there are in the text
  - \floatplacement{figure}{H} # keep figures where there are in the text
---

# Цель работы

Целью данной лабораторной работы приобретение навыков написания программ с использованием циклов и обработкой аргументов командной строки.

# Задание

1. Реализация циклов в NASM.
2. Обработка аргументов командной строки.
3. Задание для самостоятельной работы.

# Теоретическое введение

	Стек — это структура данных, организованная по принципу LIFO («Last In — First Out» или «последним пришёл — первым ушёл»). Стек является частью архитектуры процессора и реализован на аппаратном уровне. Для работы со стеком в процессоре есть специальные регистры (ss, bp, sp) и команды. 
	Основной функцией стека является функция сохранения адресов возврата и передачи аргументов при вызове процедур. Кроме того, в нём выделяется память для локальных переменных и могут временно храниться значения регистров.
	Стек имеет вершину, адрес последнего добавленного элемента, который хранится в регистре esp (указатель стека). Противоположный конец стека называется дном. Значение, помещённое в стек последним, извлекается первым. При помещении значения в стек указатель стека уменьшается, а при извлечении — увеличивается.
	Для стека существует две основные операции:
• добавление элемента в вершину стека (push);
• извлечение элемента из вершины стека (pop).
	Команда push размещает значение в стеке, т.е. помещает значение в ячейку памяти, на которую указывает регистр esp, после этого значение регистра esp увеличивается на 4. Данная команда имеет один операнд — значение, которое необходимо поместить в стек.
	Существует ещё две команды для добавления значений в стек. Это команда pusha, которая помещает в стек содержимое всех регистров общего назначения в следующем порядке: ах, сх, dx, bх, sp, bp, si, di. А также команда pushf, которая служит для перемещения в стек содержимого регистра флагов. Обе эти команды не имеют операндов.
	Команда pop извлекает значение из стека, т.е. извлекает значение из ячейки памяти, на которую указывает регистр esp, после этого уменьшает значение регистра esp на 4. У этой команды также один операнд, который может быть регистром или переменной в памяти. 
	Нужно помнить, что извлечённый из стека элемент не стирается из памяти и остаётся как “мусор”, который будет перезаписан при записи нового значения в стек.
	Примеры:
pop eax ; Поместить значение из стека в регистр eax
pop [buf] ; Поместить значение из стека в buf
pop word[si] ; Поместить значение из стека в слово по адресу в si
	Для организации циклов существуют специальные инструкции. Для всех инструкций максимальное количество проходов задаётся в регистре ecx. Наиболее простой является инструкция loop. 
	Иструкция loop выполняется в два этапа. Сначала из регистра ecx вычитается единица и его значение сравнивается с нулём. Если регистр не равен нулю, то выполняется переход к указанной метке. Иначе переход не выполняется и управление передаётся команде, которая следует сразу после команды loop.

# Выполнение лабораторной работы

Сначала создаю каталог для программ лабораторной работы № 8, перехожу в него и создаю файл lab8-1.asm (рис. [-@fig:001]).

![Создание файла](image/1.png){#fig:001 width=70%}

Ввожу в файл lab8-1.asm текст программы из листинга 8.1 (рис. [-@fig:002]).

![Ввод текста из листинга](image/2.png){#fig:002 width=70%}

Создаю исполняемый файл и проверяю его работу (рис. [-@fig:003]).

![Создание исполняемого файла](image/3.png){#fig:003 width=70%}

Далее изменяю текст программы, добавив изменение значение регистра ecx в цикле (рис. [-@fig:004]).

![Изменение текста программы](image/4.png){#fig:004 width=70%}

Создаю исполняемый файл и проверяю его работу (рис. [-@fig:005]). Изменение регистра ecx привела к некорретной работе программы, она запускает бесконечный цикл.

![Создание исполняемого файла](image/5.png){#fig:005 width=70%}

Вношу изменения в текст программы, добавив команды push и pop для сохранения значения счетчика цикла loop (рис. [-@fig:006]).

![Изменение текста программы](image/6.png){#fig:006 width=70%}

Создаю исполняемый файл и проверяю его работу (рис. [-@fig:007]). В данном случае число проходов цикла соответствует значению N, введенному с клавиатуры.

![Создание исполняемого файла](image/7.png){#fig:007 width=70%}

Затем создаю файл lab8-2.asm в каталоге ~/work/arch-pc/lab08 и ввожу в него текст программы из листинга 8.2 (рис. [-@fig:008]).

![Ввод текста из листинга](image/8.png){#fig:008 width=70%}

Создаю исполняемый файл и запускаю его, указав аргументы (рис. [-@fig:009]). Программой было обработано 4 аргумента.

![Создание исполняемого файла](image/9.png){#fig:009 width=70%}

Далее создаю файл lab8-3.asm в каталоге ~/work/arch-pc/lab08 и введите в него текст программы из листинга 8.3 (рис. [-@fig:010]).

![Ввод текста из листинга](image/10.png){#fig:010 width=70%}

Создаю исполняемый файл и запускаю его, указав аргументы (рис. [-@fig:011]).

![Создание исполняемого файла](image/11.png){#fig:011 width=70%}

Изменяю текст программы из листинга 8.3 для вычисления произведения аргументов командной строки (рис. [-@fig:012]).

![Изменение текста программы](image/12.png){#fig:012 width=70%}

Создаю исполняемый файл и запускаю его, указав аргументы (рис. [-@fig:013]).

![Создание исполняемого файла](image/13.png){#fig:013 width=70%}

##  Задание для самостоятельной работы

Пишу программу, которая находит сумму значений функции f(x) для x=x1,x2,..,хn, т.е. программа должна выводить значение f(x1)+f(x2)+...+f(xn). Значения хі передаются как аргументы. Мой вариант - 4, моя функция: 2(x-1) (рис. [-@fig:014]).

![Программа для вывода значения функции](image/14.png){#fig:014 width=70%}

Создаю исполняемый файл и запускаю его, указав аргументы (рис. [-@fig:015]).

![Создание исполняемого файла](image/15.png){#fig:015 width=70%}

# Выводы

В ходе данной лабораторной работы я приобрела навыки написания программ с использованием циклов и обработкой аргументов командной строки.

# Список литературы{.unnumbered}

1. https://esystem.rudn.ru/mod/resource/view.php?id=1030847
